services:
    cache_time_keeper.driver.dummy:
        class: AnimeDb\Bundle\CacheTimeKeeperBundle\Service\Driver\Dummy
        public: false

    cache_time_keeper.driver.file:
        class: AnimeDb\Bundle\CacheTimeKeeperBundle\Service\Driver\File
        arguments: [ %cache_time_keeper.driver.file% ]
        public: false

    cache_time_keeper:
        class: AnimeDb\Bundle\CacheTimeKeeperBundle\Service\Keeper
        arguments: [ @cache_time_keeper.driver ]

    cache_time_keeper.listener.entity:
        class: AnimeDb\Bundle\CacheTimeKeeperBundle\Event\Listener\Entity
        arguments: [ @cache_time_keeper ]
        tags:
            - { name: doctrine.event_listener, event: postRemove }
            - { name: doctrine.event_listener, event: postPersist }
            - { name: doctrine.event_listener, event: postUpdate }
        public: false

    cache_time_keeper.listener.console:
        class: AnimeDb\Bundle\CacheTimeKeeperBundle\Event\Listener\Console
        arguments: [ @cache_time_keeper, @cache_time_keeper.driver ]
        tags:
            - { name: kernel.event_listener, event: console.terminate, method: onTerminate }
        public: false

    cache_time_keeper.listener.request:
        class: AnimeDb\Bundle\CacheTimeKeeperBundle\Event\Listener\Request
        arguments: [ @cache_time_keeper.driver ]
        tags:
            - { name: kernel.event_listener, event: kernel.terminate, method: onTerminate }
        public: false